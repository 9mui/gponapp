{% extends "base.html" %}
{% block content %}

<h2 style="display:flex; align-items:center; justify-content:space-between;">
  <span>{{ ip }} ‚Äî {{ port_name }}</span>
  <form method="post"
        action="{{ url_for('port_bounce', ip=ip, ifindex=ifindex) }}"
        onsubmit="return confirm('–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å (down‚Üíup) —ç—Ç–æ—Ç PON-–ø–æ—Ä—Ç?')"
        style="margin:0;">
    <button class="btn warn" style="padding:6px 12px; font-size:0.9rem;">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Ä—Ç</button>
  </form>
</h2>

<p>
  –°—Ç–∞—Ç—É—Å –ø–æ—Ä—Ç–∞:
  {% if port_status == 1 %}UP{% elif port_status == 2 %}DOWN{% else %}-{% endif %} |
  PON TX: {{ pon_tx if pon_tx is not none else "-" }} dBm |
  PON RX: {{ pon_rx if pon_rx is not none else "-" }} dBm
</p>

<style>
  /* –û–±—â–∞—è —Ç—ë–º–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞ ‚Äî –∫–∞–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ONU */
  body{ background:#0f141b; color:#e5e7eb; }

  /* –ë–∞–∑–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ (–µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω—ã –≤ base.html) */
  .btn{ display:inline-block; border:none; border-radius:6px; padding:8px 14px; font-size:14px; cursor:pointer; text-align:center; }
  .btn.warn{ background:#dc3545; color:#fff; }
  .btn.warn:hover{ background:#b52a38; }

  /* –ú—è–≥–∫–∞—è —Å–∏–Ω—è—è –∫–Ω–æ–ø–∫–∞ –≤ –æ–±—â–µ–π —Å—Ç–∏–ª–∏—Å—Ç–∏–∫–µ */
  .btn.soft{
    background:#1e2a36;
    color:#cfe4ff;
    border:1px solid #334b62;
  }
  .btn.soft:hover{ background:#263545; }

  /* –°—Å—ã–ª–∫–∏ SN ‚Äî –±–µ–ª—ã–µ, –∫—Ä—É–ø–Ω–µ–µ, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ hover/visited */
  a.sn-link{
    color:#e5e7eb;
    text-decoration:none;
    font-size:18px;
    font-weight:600;
    letter-spacing:.2px;
  }
  a.sn-link:visited,
  a.sn-link:hover,
  a.sn-link:focus,
  a.sn-link:active{
    color:#e5e7eb;
    text-decoration:none;
    outline:none;
  }

  /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —è—á–µ–π–∫–∏ —Å —Å–µ—Ä–∏–π–Ω–∏–∫–æ–º –ø–æ —Ü–µ–Ω—Ç—Ä—É */
  td.sn-col{ text-align:center; }

  /* –§–æ—Ä–º–∞ –∏ –ø–æ–ª–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è */
  .comment-form{
    display:flex;
    align-items:flex-start;
    gap:8px;
    width:100%;
  }
  .ta-note{
    flex:1 1 auto;
    width:100%;
    min-height:44px;          /* —Å—Ç–∞—Ä—Ç: ~2 —Å—Ç—Ä–æ–∫–∏ */
    max-height:40vh;          /* –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—ã—Å–æ—Ç–µ */
    resize:vertical;          /* –†–ï–°–ê–ô–ó –¢–û–õ–¨–ö–û –ü–û –í–ï–†–¢–ò–ö–ê–õ–ò */
    overflow:auto;
    padding:10px 12px;
    border-radius:10px;
    background:rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.12);
    color:#e5e7eb;
    box-sizing:border-box;
  }

  /* –¢–∞–±–ª–∏—Ü–∞ */
  table.table-onus{
    border-collapse:collapse; width:100%;
    font-family:sans-serif; font-size:17px;
    background:transparent;
  }
  table.table-onus th, table.table-onus td{
    border:1px solid #2a2f3a;
    padding:6px 10px; text-align:left; vertical-align:middle;
    color:#e5e7eb; background:transparent;
  }
  table.table-onus td.sn-col {
    text-align: center; 
  }
  table.table-onus th{ color:#cbd5e1; font-weight:600; }
</style>

{% if onus %}
<table class="table-onus">
  <!-- –ü–æ–º–µ–Ω—è–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –∫–æ–ª–æ–Ω–æ–∫ –∏ –∑–∞–¥–∞–ª–∏ —à–∏—Ä–∏–Ω—ã:
       1) ONU-ID (—É–∂–µ),
       2) Serial Number (—à–∏—Ä–µ),
       3) –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ—Å—Ç–∞–ª—å–Ω–æ–µ). -->
  <colgroup>
    <col style="width:7%;">  <!-- ONU-ID -->
    <col style="width:33%;">  <!-- Serial Number -->
    <col style="width:60%;">  <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π -->
  </colgroup>
  <thead>
    <tr>
      <th>ONU-ID</th>
      <th>Serial Number</th>
      <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
    </tr>
  </thead>
  <tbody>
    {% for sn, onuid, note in onus %}
    <tr>
      <td>{{ onuid }}</td>
      <td class="sn-col"><a class="sn-link" href="{{ url_for('onu_by_sn', sn=sn) }}">{{ sn }}</a></td>
      <td>
        <form method="post" action="{{ url_for('save_onu_note', sn=sn) }}" class="comment-form">
          <textarea name="note" placeholder="–ó–∞–º–µ—Ç–∫–∞‚Ä¶" rows="2" class="ta-note">{{- note or '' -}}</textarea>
          <button class="btn soft" type="submit" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">üíæ</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>–ù–∞ —ç—Ç–æ–º –ø–æ—Ä—Ç—É ONU –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
{% endif %}

{% endblock %}
